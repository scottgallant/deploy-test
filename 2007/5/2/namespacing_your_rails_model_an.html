<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>paperplanes. Namespacing Your Rails Model - An Afterthought</title>
    <meta name="robots" content="index,follow"/>
    <meta name="mssmarttagspreventparsing" content="true"/>
    <link rel="shortcut icon" href="/images/favicon.gif" type="image/gif" />
    <link rel="icon" href="/images/favicon.gif" type="image/gif" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  	<meta name="author" content="Mathias Meyer"/>
    <meta name="dc.title" content="paperplanes. Namespacing Your Rails Model - An Afterthought"/>
  	<link rel="start" href="http://www.paperplanes.de" title="paperplanes"/>
     
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="Namespacing Your Rails Model - An Afterthought"/>
    <meta name="twitter:site" content="@roidrage"/>
    <meta name="twitter:creator" content="@roidrage"/>
    <meta name="twitter:description" content="In an earlier post I wrote about namespacing your Rails model. There&#39;s an additional issue that must be thought of when doing so. Rails (of course) has conventions dealing with namespaces.

Nor..."/>
    <meta name="twitter:url" content="http://www.paperplanes.de/2007/5/2/namespacing_your_rails_model_an.html"/>
    <meta name="twitter:domain" content="paperplanes.de"/>
    
    <link href="http://www.paperplanes.de/rss.xml" rel="alternate" title="Primary Feed" type="application/rss+xml" />
    <link href="/stylesheets/screen.css" media="screen" rel="Stylesheet" title="paperplanes" type="text/css" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/mobile.css" media="handheld, only screen and (max-device-width: 960px)" />
  </head>
  
  <body id="www-paperplanes-de">
    <div id="head">
      <div id="header-content">
        <a href="/">
          <img src="/images/paperplane.png" id="paperplane">
        </a>
        <div id="about">
          <h1 class="default">Hi, I'm Mathias Meyer, nice to meet you!</h1>
          <h1 class="mobile">Hi, I'm <a href="https://twitter.com/roidrage">Mathias Meyer</a>, I'm the CEO at <a href="https://travis-ci.com">Travis CI</a></h1>
          <p style="color: white" class="about-sub-title default">
            I'm the CEO at <a href="http://travis-ci.com">Travis CI</a>. I like coffee, <a href="https://twitter.com/roidrage">Twitter</a> and <a href="mailto:meyer@paperplanes.de">email</a>.
          </p>
        </div>
      </div>
    </div>

    <div id="box">
      <div id="content">
        <article class="hentry">
  <div class="item_perma">
    <div class="item_details">
      <header>
        <h3 class="entry-title">Namespacing Your Rails Model - An Afterthought</h3>
        <h4><a href="/2007/5/2/namespacing_your_rails_model_an.html" title="Permalink for this post">02 May 2007</a> by <a href="http://twitter.com/roidrage">Mathias Meyer</a></h4>
      </header>
    </div>
    <div class="item_content">
      <p>In an earlier post I wrote about <a href="http://www.paperplanes.de/archives/2007/4/27/namespace_your_rails_model/">namespacing your Rails model</a>. There&#39;s an additional issue that must be thought of when doing so. Rails (of course) has conventions dealing with namespaces.</p>

<p>Normally, when you put classes in namespaces, like <code>Admin::User</code>, Rails normally expects this class to be in a folder <code>admin</code> in your <code>app/models</code> directory. Responsible for this is the method <code>load_missing_constant</code> in the module Dependencies, part of ActiveSupport. It also uses the namespace to build the table name. So <code>Admin::User</code> would result in <code>admin_users</code>. This isn&#39;t always a desirable outcome. Of course you could set a table name explicitly:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">class Admin::User &lt; ActiveRecord::Base
  set_table_name &quot;users&quot;
end
</code></pre></div>
<p>If you need to avoid namespace clashes, that&#39;s an acceptable option. But what if you only want to bring some order to your model directory? You want to create some subfolders to separate your model physically, if only to avoid having dozens of files in the model folder.</p>

<p>This is where <code>load_missing_constant</code> kicks in again. If you don&#39;t load the files in the subdirectories explicitly, it will assume that the files are in their according namespace. So having a class <code>User</code> in a file <code>user.rb</code> lying in the folder <code>app/models/admin/</code> will lead it to assume <code>User</code> exists in the module <code>Admin</code>. To avoid that you&#39;ll have to add your model subfolders as load paths. To do that you can add the following line to your environment.rb:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">config.load_paths += Dir[&quot;#{RAILS_ROOT}/app/models/[a-z]*&quot;]
</code></pre></div>
<p>This will tell Rails to look for the the files in all subfolders of <code>app/models</code> on startup. This won&#39;t solve the issue yet, you&#39;ll still need to explicitly load the classes. So you put the following lines at the end of your <code>environment.rb</code>:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">[ &quot;app/models&quot; ].each do |path|
  Dir[&quot;#{RAILS_ROOT}/#{path}/**/*.rb&quot;].each do |file|
    load file
  end
end
</code></pre></div>
<p>That way you&#39;ll avoid the implicit call to <code>load_missing_constant</code>. You can add directories to the list, e.g. a subdirectory in <code>lib</code>. You could also explicitly require the classes you need, but who wants to do that, really?</p>

    </div>
    <div class="item_meta">
      <div class="item_tags">Tags:
        
      </div>
      <div class="item_hierarchy">Hierarchy:
        
          <a href="/2007/5/1/microsoft_announces_ironruby.html" title="Previous post">previous</a>
        
        
        
          , <a href="/2007/5/20/rubyfx_script_announced.html" title="Next post">next</a>
        
        </div>
    </div>
  </div>
</article>

       
        <div id="footer">
          <div id="footer_text">
            <a href="/archives.html">Archives</a>, <a href="http://www.paperplanes.de/rss.xml" title="Full-text RSS feed">RSS Feed</a>, &copy; 2007-2014 Mathias Meyer <a href="/imprint.html">Imprint</a>
          </div>
        </div>
      </div>
    </div>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-46305173-1', 'paperplanes.de');
      ga('send', 'pageview');

    </script>
  </body>
  <script src="//my.hellobar.com/7db1d1ae6111ae95568efbbf8e6a1ee953ad854f.js" type="text/javascript" charset="utf-8" async="async"></script>
</html>
