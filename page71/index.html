<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>paperplanes. mathias meyer.</title>
    <meta name="robots" content="index,follow"/>
    <meta name="mssmarttagspreventparsing" content="true"/>
    <link rel="shortcut icon" href="/images/favicon.gif" type="image/gif" />
    <link rel="icon" href="/images/favicon.gif" type="image/gif" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  	<meta name="author" content="Mathias Meyer"/>
    <meta name="dc.title" content="paperplanes. mathias meyer."/>
  	<link rel="start" href="http://www.paperplanes.de" title="paperplanes"/>
    
    <link href="http://www.paperplanes.de/rss.xml" rel="alternate" title="Primary Feed" type="application/rss+xml" />
    <link href="/stylesheets/screen.css" media="screen" rel="Stylesheet" title="paperplanes" type="text/css" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/mobile.css" media="handheld, only screen and (max-device-width: 960px)" />
  </head>
  
  <body id="www-paperplanes-de">
    <div id="head">
      <div id="header-content">
        <a href="/">
          <img src="/images/paperplane.png" id="paperplane">
        </a>
        <div id="about">
          <h1 class="default">Hi, I'm Mathias Meyer, nice to meet you!</h1>
          <h1 class="mobile">Hi, I'm <a href="https://twitter.com/roidrage">Mathias Meyer</a>, I'm the CEO at <a href="https://travis-ci.com">Travis CI</a></h1>
          <p style="color: white" class="about-sub-title default">
            I'm the CEO at <a href="http://travis-ci.com">Travis CI</a>. I like coffee, <a href="https://twitter.com/roidrage">Twitter</a> and <a href="mailto:meyer@paperplanes.de">email</a>.
          </p>
        </div>
      </div>
    </div>

    <div id="box">
      <div id="content">
        <div id="articles">

  <article>
    <div class="item">
      <div class="item_details">
        <h3><a href="/2007/10/19/advancing_with_rails_training_with.html">"Advancing with Rails" Training with David Black</a></h3>
        <h4><a href="/2007/10/19/advancing_with_rails_training_with.html" title=""Advancing with Rails" Training with David Black">19 October 2007</a> by <a href="http://twitter.com/roidrage">Mathias Meyer</a></h4>
      </div>
      <div class="item_content">
        <p><a href="http://dablog.rubypal.com/">David A. Black</a> of <a href="http://www.rubypal.com">Ruby Power and Light</a> will be giving a four-day training in Berlin from November 19th to 22th 2007. The training targets intermediate Rails developers who already worked with Rails and are familiar with the basics. Topics include ActiveRecord (attribute handling, associations, optimisations), routing, REST, testing and deployment.</p>

<p>You can find the full details (in German) on the <a href="http://www.railsschulung.de">official website</a>. Seating is limited, so hurry!</p>

      </div>
      <div class="item_meta">
        <span class="item_tags">
          Tags: 
          
        </span>
      </div>
    </div>
  </article>

  <article>
    <div class="item">
      <div class="item_details">
        <h3><a href="/2007/10/11/an_article_on_ferret.html">An Article on Ferret</a></h3>
        <h4><a href="/2007/10/11/an_article_on_ferret.html" title="An Article on Ferret">11 October 2007</a> by <a href="http://twitter.com/roidrage">Mathias Meyer</a></h4>
      </div>
      <div class="item_content">
        <p>Together with <a href="http://blog.omdb-beta.org">Benjamin Krause</a> I wrote an article on the <a href="http://ferret.davebalmain.com/trac/">Ferret</a> and <a href="http://projects.jkraemer.net/acts_as_ferret/">acts_as_ferret</a> for the German IT magazine <a href="http://www.ix.de/">iX</a> which was published today. The article is part of a Ruby on Rails special which also includes articles on the current state of Rails and <a href="http://www.heise.de/ix/artikel/2007/11/058">deployment with Capistrano</a>, both written by <a href="http://www.b-simple.de/">Ralf Wirdemann and Thomas Baustert</a>. Go grab it while it&#39;s hot (and available).</p>

<p>In other news, everyone&#39;s favorite freelancing site <a href="http://freelanceswitch.com">FreelanceSwitch</a> recently started a podcast called <a href="http://freelanceswitch.com/podcasts">&quot;Freelance Radio&quot;</a>. I highly recommend checking it out.</p>

      </div>
      <div class="item_meta">
        <span class="item_tags">
          Tags: 
          
        </span>
      </div>
    </div>
  </article>

  <article>
    <div class="item">
      <div class="item_details">
        <h3><a href="/2007/9/27/using_railslike_environments_with_spring.html">Using Rails-like Environments with Spring</a></h3>
        <h4><a href="/2007/9/27/using_railslike_environments_with_spring.html" title="Using Rails-like Environments with Spring">27 September 2007</a> by <a href="http://twitter.com/roidrage">Mathias Meyer</a></h4>
      </div>
      <div class="item_content">
        <p>One thing that&#39;s nice about Rails is the separation of test, development and production environment right from the beginning. I&#39;m currently working on a Java project with Spring and found myself using MySQL for most of the development and testing and Oracle in production. Using Hibernate that&#39;s not a big problem (most of the time that is, unless you&#39;re bitten in the ass by another weird Oracle JDBC driver bug), but I don&#39;t want to change all the properties for every deployment.</p>

<p>There&#39;s a neat trick to achieve a similar functionality using Spring. As you do in Rails you basically put all the properties that are different in every environments into separate files, e.g.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">project-test.properties
project-development.properties
project-production.properties
</code></pre></div>
<p>First thing that comes to mind is the specification of the database connection properties and Hibernate specifics.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">jdbc.url=jdbc:mysql://localhost/my_database_test
jdbc.user=scott
jdbc.password=tiger
jdbc.driver=com.mysql.jdbc.Driver
hibernate.dialect=org.hibernate.dialect.MySQL5Dialect
</code></pre></div>
<p>I also put in web service configurations so that I can use different configurations or even mock services during development.</p>

<p>Now let&#39;s have a look at the Spring configuration. The important part is the configuration of a PropertyPlaceHolderConfigurer. Basically, that&#39;s the class that is responsible for resolving the properties which I&#39;ll use in the XML configuration later on.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">&lt;bean id=&quot;propertyConfigurer&quot; 
      class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;&gt;
  &lt;property name=&quot;systemPropertiesMode&quot; value=&quot;1&quot;/&gt;
  &lt;property name=&quot;locations&quot;&gt;
    &lt;list&gt;
      &lt;value&gt;classpath:project-production.properties&lt;/value&gt;
      &lt;value&gt;classpath:project-development.properties&lt;/value&gt;
      &lt;value&gt;classpath:project-test.properties&lt;/value&gt;
    &lt;/list&gt;
  &lt;/property&gt;
  &lt;property name=&quot;ignoreResourceNotFound&quot; value=&quot;true&quot;/&gt;
&lt;/bean&gt;
</code></pre></div>
<p>This will read read all the properties from the listed properties files. The rule is that the properties in the last file win, so development overwrites production, and test overwrites development. One thing to mention is the property <code>ignoreResourceNotFound</code> which defaults to <code>false</code>. That way the configurer throws an exception when he can&#39;t find one of the properties files. I set it to true so that I can just remove the test file for the development environment and the development file for the production environment.</p>

<p>You can put these files in your JAR file, or into WEB-INF/classes. My setup puts the project-test.properties into my test/ folder so that it&#39;s not even included in the deployment. For a production deployment I just remove the development file during the build and I&#39;m good to go.</p>

<p>What you can now do in your configuration is this</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">&lt;bean id=&quot;dataSource&quot;
      class=&quot;org.apache.commons.dbcp.BasicDataSource&quot;
      destroy-method=&quot;close&quot;&gt;
  &lt;property name=&quot;driverClassName&quot; value=&quot;${jdbc.driver}&quot;/&gt;
  &lt;property name=&quot;url&quot; value=&quot;${jdbc.url}&quot;/&gt;
  &lt;property name=&quot;username&quot; value=&quot;${jdbc.user}&quot;/&gt;
  &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot;/&gt;
&lt;/bean&gt;

&lt;bean id=&quot;sessionFactory&quot;&gt;
&lt;bean id=&quot;sessionFactory&quot;
      class=&quot;org.springframework.orm.hibernate3.LocalSessionFactoryBean&quot;&gt;
  &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt;
  &lt;property name=&quot;hibernateProperties&quot;&gt;
    &lt;props&gt;
      &lt;prop key=&quot;hibernate.dialect&quot;&gt;${hibernate.dialect}&lt;/prop&gt;
    &lt;/props&gt;
  &lt;/property&gt;
&lt;/bean&gt;
</code></pre></div>
<p>These properties can also be used to configure bean references. For testing and development I use a mocked web service implementation which I can switch through the property</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">web.service=mockedWebService
</code></pre></div>
<p>If I have defined a bean with the id <code>mockedWebService</code> I can now safely use a property to reference it.</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">&lt;bean id=&quot;someService&quot;
      class=&quot;some.Class&quot;&gt;
  &lt;property name=&quot;webService&quot; ref=&quot;${web.service}&quot;/&gt;
&lt;/bean&gt;
</code></pre></div>
<p>You can even specify properties files based on system properties:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">&lt;bean id=&quot;propertyConfigurer&quot; 
      class=&quot;org.springframework.beans.factory.config.PropertyPlaceholderConfigurer&quot;&gt;
  &lt;property name=&quot;systemPropertiesMode&quot; value=&quot;1&quot;/&gt;
  &lt;property name=&quot;locations&quot;&gt;
    &lt;list&gt;
      &lt;value&gt;classpath:project-${environment}.properties&lt;/value&gt;
      &lt;value&gt;classpath:project-${user.name}&lt;/value&gt;
    &lt;/list&gt;
  &lt;/property&gt;
  &lt;property name=&quot;ignoreResourceNotFound&quot; value=&quot;true&quot;/&gt;
&lt;/bean&gt;
</code></pre></div>
<p>If you add the property environment to the startup command of whatever you&#39;re using you can specify the environment during startup, or use an approach based on the login user&#39;s name.</p>

<p>While not a perfect solution I found it to be a lot easier to work with than editing Spring configuration by hand or having a separate XML configuration for the different stages.</p>

      </div>
      <div class="item_meta">
        <span class="item_tags">
          Tags: 
          
        </span>
      </div>
    </div>
  </article>

</div>

<div class="pagination">
  
    
      <a href="/page70" class="previous">Newer Posts</a>
    
  
  
    <a href="/page72" class="next">Older Posts</a>
  
</div>

       
        <div id="footer">
          <div id="footer_text">
            <a href="/archives.html">Archives</a>, <a href="http://www.paperplanes.de/rss.xml" title="Full-text RSS feed">RSS Feed</a>, &copy; 2007-2014 Mathias Meyer <a href="/imprint.html">Imprint</a>
          </div>
        </div>
      </div>
    </div>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-46305173-1', 'paperplanes.de');
      ga('send', 'pageview');

    </script>
  </body>
  <script src="//my.hellobar.com/7db1d1ae6111ae95568efbbf8e6a1ee953ad854f.js" type="text/javascript" charset="utf-8" async="async"></script>
</html>
