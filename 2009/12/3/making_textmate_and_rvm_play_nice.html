<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>paperplanes. Making TextMate And rvm Play Nice</title>
    <meta name="robots" content="index,follow"/>
    <meta name="mssmarttagspreventparsing" content="true"/>
    <link rel="shortcut icon" href="/images/favicon.gif" type="image/gif" />
    <link rel="icon" href="/images/favicon.gif" type="image/gif" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
  	<meta name="author" content="Mathias Meyer"/>
    <meta name="dc.title" content="paperplanes. Making TextMate And rvm Play Nice"/>
  	<link rel="start" href="http://www.paperplanes.de" title="paperplanes"/>
     
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="Making TextMate And rvm Play Nice"/>
    <meta name="twitter:site" content="@roidrage"/>
    <meta name="twitter:creator" content="@roidrage"/>
    <meta name="twitter:description" content="After being annoyed with running multiple versions of Ruby just by using MacPorts I finally gave in and tried out rvm, the Ruby Version Manager. That stuff got even more annoying when I tried to ma..."/>
    <meta name="twitter:url" content="http://www.paperplanes.de/2009/12/3/making_textmate_and_rvm_play_nice.html"/>
    <meta name="twitter:domain" content="paperplanes.de"/>
    
    <link href="http://www.paperplanes.de/rss.xml" rel="alternate" title="Primary Feed" type="application/rss+xml" />
    <link href="/stylesheets/screen.css" media="screen" rel="Stylesheet" title="paperplanes" type="text/css" />
    <link rel="stylesheet" type="text/css" href="/stylesheets/mobile.css" media="handheld, only screen and (max-device-width: 960px)" />
  </head>
  
  <body id="www-paperplanes-de">
    <div id="head">
      <div id="header-content">
        <a href="/">
          <img src="/images/paperplane.png" id="paperplane">
        </a>
        <div id="about">
          <h1 class="default">Hi, I'm Mathias Meyer, nice to meet you!</h1>
          <h1 class="mobile">Hi, I'm <a href="https://twitter.com/roidrage">Mathias Meyer</a>, I'm the CEO at <a href="https://travis-ci.com">Travis CI</a></h1>
          <p style="color: white" class="about-sub-title default">
            I'm the CEO at <a href="http://travis-ci.com">Travis CI</a>. I like coffee, <a href="https://twitter.com/roidrage">Twitter</a> and <a href="mailto:meyer@paperplanes.de">email</a>.
          </p>
        </div>
      </div>
    </div>

    <div id="box">
      <div id="content">
        <article class="hentry">
  <div class="item_perma">
    <div class="item_details">
      <header>
        <h3 class="entry-title">Making TextMate And rvm Play Nice</h3>
        <h4><a href="/2009/12/3/making_textmate_and_rvm_play_nice.html" title="Permalink for this post">03 December 2009</a> by <a href="http://twitter.com/roidrage">Mathias Meyer</a></h4>
      </header>
    </div>
    <div class="item_content">
      <p>After being annoyed with running multiple versions of Ruby just by using MacPorts I finally gave in and tried out <a href="http://rvm.beginrescueend.com/">rvm, the Ruby Version Manager</a>. That stuff got even more annoying when I tried to make <a href="http://github.com/wycats/bundler/">Bundler</a> behave well with multiple Ruby versions, because it just doesn&#39;t by default. It&#39;s not really a problem with normal gems, but Bundler falls apart with its defaults when you&#39;re trying to run gems with native extensions. Hint: Set bundle_path to include RUBY_VERSION and make some links from one cache directory to another to not have every gem cached for every Ruby version.</p>

<p>The promise of being able to easily switch between different versions and still having just one ruby binary and not one called ruby1.9 with MacPorts is just neat. While installing them is straight forward, using them from e.g. TextMate is not great. The common solutions of <a href="http://groups.google.com/group/rubyversionmanager/browse_thread/thread/c40041fa44012117#">just launching it from the command line</a> or <a href="http://rvm.beginrescueend.com/faq/">modifying the TextMate Ruby bundle</a> (these changes will have to be made again with the next TextMate update) are not fully acceptable for me, because it still doesn&#39;t allow me to switch Ruby versions while TextMate is running. That&#39;s one &quot;flaw&quot; rvm has, at least for me. It switches the paths for the Ruby versions for the current shell, it doesn&#39;t offer anything to set links in ~/.rvm/bin to the currently active Ruby version, at least as far as I know. No big deal, if it&#39;s by design I can live with that, I do think it&#39;d be a nice addition though.</p>

<p>Anyway, I wanted to switch Ruby versions from my shell and have it affect the version I&#39;m using to run my tests from TextMate too. The way to go seems to be <code>rvm &lt;version&gt; --default</code> which will set the default for all other shells. Be aware that it will do what it says, but I could live with that. It&#39;s more important to me to be able to make that switch than just having several shells with different versions in each. First step was to shorten that command, because let&#39;s face it, that&#39;s a lot of text. I added a function to my .zshrc. It should work just as well with bash, but really, you&#39;re still using bash?</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">rvmd() {rvm use $1 --default}
</code></pre></div>
<p>Now you can just <code>rvmd 1.9.1</code> in your shell prompt and be done with it. Much better.</p>

<p>The other part was telling TextMate what Ruby binary to use. The problem outlined above made that a bit of a pain, so I broke out my shell scripting fu and cranked out this amazing wrapper script, using what rvm already dumps in your rc files:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">#!/bin/zsh
if [[ -s /Volumes/Users/pom/.rvm/scripts/rvm ]]
then
  source /Volumes/Users/pom/.rvm/scripts/rvm
fi
`which ruby` $*
</code></pre></div>
<p>Impressive, eh? It just sources the rvm script and then calls the ruby binary that is currently set as default. Make it executable and set a shell variable in TextMate called TM_RUBY and make it point to that script, and you&#39;re good to go.</p>

    </div>
    <div class="item_meta">
      <div class="item_tags">Tags:
        
      </div>
      <div class="item_hierarchy">Hierarchy:
        
          <a href="/2009/10/30/how_to_redis.html" title="Previous post">previous</a>
        
        
        
          , <a href="/2010/1/12/redis_and_rails_sitting_on_the_couch.html" title="Next post">next</a>
        
        </div>
    </div>
  </div>
</article>

       
        <div id="footer">
          <div id="footer_text">
            <a href="/archives.html">Archives</a>, <a href="http://www.paperplanes.de/rss.xml" title="Full-text RSS feed">RSS Feed</a>, &copy; 2007-2014 Mathias Meyer <a href="/imprint.html">Imprint</a>
          </div>
        </div>
      </div>
    </div>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-46305173-1', 'paperplanes.de');
      ga('send', 'pageview');

    </script>
  </body>
  <script src="//my.hellobar.com/7db1d1ae6111ae95568efbbf8e6a1ee953ad854f.js" type="text/javascript" charset="utf-8" async="async"></script>
</html>
